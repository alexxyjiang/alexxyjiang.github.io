{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/a-powerful-tool-to-diagnosis-docker-images-dive/","result":{"data":{"markdownRemark":{"id":"f9c27eaf-d120-577e-8ba2-7cc576fb5e1b","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28277ef3a365ddd589ff90dd3bb7f8d2/4b190/docker-detective.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAB68V02XoDQzC1Df/EABsQAAMAAgMAAAAAAAAAAAAAAAECAwAQERMi/9oACAEBAAEFArV61S5DZYeU4o2kQJr/xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAwEBPwEj/8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQIBAT8BWP/EAB0QAAEEAgMAAAAAAAAAAAAAABEAARAxIkFRYWL/2gAIAQEABj8C9PSzI7iiEOJcbj//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhEDFRkf/aAAgBAQABPyEKB8EN2tdR1Bss6iIRJWRgpmt5+uuP/9oADAMBAAIAAwAAABAUyID/xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QKLj/xAAWEQEBAQAAAAAAAAAAAAAAAAARASD/2gAIAQIBAT8QGmP/xAAeEAEBAAICAgMAAAAAAAAAAAABEQAhEEExUWGB8f/aAAgBAQABPxCUTIjV36wq0xJqa/MAkqKJ3gFyQ6+cpcwaG68ffOuUq03j/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28277ef3a365ddd589ff90dd3bb7f8d2/8ac56/docker-detective.webp 240w,\n/static/28277ef3a365ddd589ff90dd3bb7f8d2/d3be9/docker-detective.webp 480w,\n/static/28277ef3a365ddd589ff90dd3bb7f8d2/d00b9/docker-detective.webp 800w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28277ef3a365ddd589ff90dd3bb7f8d2/09b79/docker-detective.jpg 240w,\n/static/28277ef3a365ddd589ff90dd3bb7f8d2/7cc5e/docker-detective.jpg 480w,\n/static/28277ef3a365ddd589ff90dd3bb7f8d2/4b190/docker-detective.jpg 800w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28277ef3a365ddd589ff90dd3bb7f8d2/4b190/docker-detective.jpg\"\n            alt=\"docker-detective\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>To diagnose docker images and get detailed information of the image, including the command history, file system changes, and size of the layers, we need powerful tools. The official <strong>docker</strong> is shipped with a few commands to help on this, but sometimes that’s not enough. Fortunately, the community has developed a more powerful tool called <strong>dive</strong>.</p>\n<h2 id=\"official-commands\" style=\"position:relative;\"><a href=\"#official-commands\" aria-label=\"official commands permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Official Commands</h2>\n<ul>\n<li><strong>docker history</strong>: To get the history of the image layers.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">docker</span> <span class=\"token function\">history</span> <span class=\"token punctuation\">[</span>image<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><strong>docker inspect</strong>: To get the detailed information of the image, including the configuration, environment variables, and labels.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">docker</span> inspect <span class=\"token punctuation\">[</span>image<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><strong>docker scout</strong>: To get the security information of the image, including the vulnerabilities and compliance issues.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">docker</span> scout quickview <span class=\"token punctuation\">[</span>image<span class=\"token punctuation\">]</span></code></pre></div>\n<h2 id=\"dive\" style=\"position:relative;\"><a href=\"#dive\" aria-label=\"dive permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dive</h2>\n<p>The output of the official docker commands is a little limited and sometimes hard to read. If we replace that with <strong>dive</strong>, we can get a more detailed and interactive view of the image layers, like,</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ dive <span class=\"token punctuation\">[</span>image<span class=\"token punctuation\">]</span></code></pre></div>\n<p>The <strong>dive</strong> will provide a more detailed view of the image layers, including the command history, file system changes, and size of the layers. It also provides an interactive view to explore the image layers, like,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">                                                                                                                      │ Current Layer Contents ├───────────────────────────────────────────────────────────────────────────────────────────\n┃ ● Layers ┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Permission     UID:GID       Size  Filetree\nCmp   Size  Command                                                                                                   drwxr-xr-x         0:0     919 kB  ├── bin\n    8.8 MB  FROM blobs                                                                                                -rwxrwxrwx         0:0        0 B  │   ├── arch → /bin/busybox\n    138 MB  RUN /bin/sh -c addgroup -g 1000 node     &amp;&amp; adduser -u 1000 -G node -s /bin/sh -D node     &amp;&amp; apk add --n -rwxrwxrwx         0:0        0 B  │   ├── ash → /bin/busybox\n    5.6 MB  RUN /bin/sh -c apk add --no-cache --virtual .build-deps-yarn curl gnupg tar   &amp;&amp; export GNUPGHOME=\"$(mkte -rwxrwxrwx         0:0        0 B  │   ├── base64 → /bin/busybox\n     388 B  COPY docker-entrypoint.sh /usr/local/bin/ # buildkit                                                      -rwxrwxrwx         0:0        0 B  │   ├── bbconfig → /bin/busybox\n     68 MB  RUN /bin/sh -c apk update   &amp;&amp; apk add --no-cache curl git tzdata util-linux vim zsh # buildkit           -rwxr-xr-x         0:0     919 kB  │   ├── busybox\n    123 MB  RUN /bin/sh -c npm install -g gatsby-cli # buildkit                                                       -rwxrwxrwx         0:0        0 B  │   ├── cat → /bin/busybox\n    3.0 kB  RUN |1 uid=1000 /bin/sh -c if [ $uid -eq 1000 ]; then deluser node; fi; # buildkit                        -rwxrwxrwx         0:0        0 B  │   ├── chattr → /bin/busybox\n    3.0 kB  RUN |1 uid=1000 /bin/sh -c adduser -u $uid -D -s /bin/zsh editor # buildkit                               -rwxrwxrwx         0:0        0 B  │   ├── chgrp → /bin/busybox\n     354 B  COPY .zshrc /home/editor/zshrc_template # buildkit                                                        -rwxrwxrwx         0:0        0 B  │   ├── chmod → /bin/busybox\n       0 B  WORKDIR /home/editor                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── chown → /bin/busybox\n     10 MB  RUN |1 uid=1000 /bin/sh -c env REPO=\"alexxyjiang/ohmyzsh\" zsh -c \"$(curl -fsSL https://raw.githubusercont -rwxrwxrwx         0:0        0 B  │   ├── cp → /bin/busybox\n    4.7 MB  RUN |1 uid=1000 /bin/sh -c zsh zshrc_template &amp;&amp; cp zshrc_template .zshrc &amp;&amp; rm zshrc_template # buildkit -rwxrwxrwx         0:0        0 B  │   ├── date → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── dd → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── df → /bin/busybox\n│ Layer Details ├──────────────────────────────────────────────────────────────────────────────────────────────────── -rwxrwxrwx         0:0        0 B  │   ├── dmesg → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── dnsdomainname → /bin/busybox\nTags:   (unavailable)                                                                                                 -rwxrwxrwx         0:0        0 B  │   ├── dumpkmap → /bin/busybox\nId:     blobs                                                                                                         -rwxrwxrwx         0:0        0 B  │   ├── echo → /bin/busybox\nDigest: sha256:16113d51b7181f20135f51e8ffbaead20a7671cd783017601f198748ce8a8ebf                                       -rwxrwxrwx         0:0        0 B  │   ├── egrep → /bin/busybox\nCommand:                                                                                                              -rwxrwxrwx         0:0        0 B  │   ├── false → /bin/busybox\n#(nop) ADD file:ee5bb8409915b11413f44cce4c22fed658aba4fb078a448e08dd4ac9a23581f2 in /                                 -rwxrwxrwx         0:0        0 B  │   ├── fatattr → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── fdflush → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── fgrep → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── fsync → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── getopt → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── grep → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── gunzip → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── gzip → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── hostname → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── ionice → /bin/busybox\n│ Image Details ├──────────────────────────────────────────────────────────────────────────────────────────────────── -rwxrwxrwx         0:0        0 B  │   ├── iostat → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── ipcalc → /bin/busybox\nImage name: alexxyjiang/blog-site-generator:latest                                                                    -rwxrwxrwx         0:0        0 B  │   ├── kbd_mode → /bin/busybox\nTotal Image size: 359 MB                                                                                              -rwxrwxrwx         0:0        0 B  │   ├── kill → /bin/busybox\nPotential wasted space: 3.6 MB                                                                                        -rwxrwxrwx         0:0        0 B  │   ├── link → /bin/busybox\nImage efficiency score: 99 %                                                                                          -rwxrwxrwx         0:0        0 B  │   ├── linux32 → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── linux64 → /bin/busybox\nCount   Total Space  Path                                                                                             -rwxrwxrwx         0:0        0 B  │   ├── ln → /bin/busybox\n    4        880 kB  /etc/ssl/certs/ca-certificates.crt                                                               -rwxrwxrwx         0:0        0 B  │   ├── login → /bin/busybox\n    4        277 kB  /lib/apk/db/installed                                                                            -rwxrwxrwx         0:0        0 B  │   ├── ls → /bin/busybox\n    2        133 kB  /sbin/fdisk                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── lsattr → /bin/busybox\n    2         70 kB  /bin/dmesg                                                                                       -rwxrwxrwx         0:0        0 B  │   ├── lzop → /bin/busybox\n    2         68 kB  /usr/bin/logger                                                                                  -rwxrwxrwx         0:0        0 B  │   ├── makemime → /bin/busybox\n    2         68 kB  /usr/bin/cal                                                                                     -rwxrwxrwx         0:0        0 B  │   ├── mkdir → /bin/busybox\n    2         68 kB  /sbin/losetup                                                                                    -rwxrwxrwx         0:0        0 B  │   ├── mknod → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── mktemp → /bin/busybox\n                                                                                                                      -rwxrwxrwx         0:0        0 B  │   ├── more → /bin/busybox</code></pre></div>","fields":{"slug":"/posts/2024-10-30---A-Powerful-Tool-to-Diagnosis-Docker-Images-\"dive\"//posts/a-powerful-tool-to-diagnosis-docker-images-dive","tagSlugs":["/tag/virtualization/","/tag/docker/"]},"frontmatter":{"date":"2024-10-30T20:00:00.000Z","description":"tips of docker image diagnosis.","tags":["Virtualization","Docker"],"title":"A Powerful Tool to Diagnosis Docker Images \"dive\"","socialImage":{"publicURL":"/static/28277ef3a365ddd589ff90dd3bb7f8d2/docker-detective.jpg"}}}},"pageContext":{"slug":"/posts/2024-10-30---A-Powerful-Tool-to-Diagnosis-Docker-Images-\"dive\"//posts/a-powerful-tool-to-diagnosis-docker-images-dive"}},"staticQueryHashes":["251939775","288581551","401334301"],"slicesMap":{}}